<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Session 5 lab exercise: loglinear regression part 2 â€¢ session5</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Session 5 lab exercise: loglinear regression part 2">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-176789980-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-176789980-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">session5</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Lecture and Lab

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/session_lecture.html">Lecture notes</a>
    </li>
    <li>
      <a href="../articles/session_lecture.pdf">Lecture notes PDF</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../articles/session_lab.html">Lab materials</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/leviwaldron1" class="external-link">
    <span class="fab fa-twitter fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Session 5 lab exercise: loglinear regression
part 2</h1>
                        <h4 data-toc-skip class="author">Levi
Waldron</h4>
            
      

      <div class="hidden name"><code>session_lab.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 class="unnumbered" id="learning-objectives">Learning objectives<a class="anchor" aria-label="anchor" href="#learning-objectives"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Fit Poisson, NB, and zero-inflated loglinear models</li>
<li>Perform nested deviance test for model selection</li>
<li>Make diagnostic plots of loglinear models</li>
<li>Visually assess multicollinearity among predictors</li>
</ol>
</div>
<div class="section level2">
<h2 id="load-the-needle-sharing-dataset">Load the needle-sharing dataset<a class="anchor" aria-label="anchor" href="#load-the-needle-sharing-dataset"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">needledat</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"needle_sharing.csv"</span><span class="op">)</span></span>
<span><span class="va">needledat2</span> <span class="op">&lt;-</span> <span class="va">needledat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sex</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"M"</span>, <span class="st">"F"</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>                  <span class="va">ethn</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"White"</span>, <span class="st">"AA"</span>, <span class="st">"Hispanic"</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>                  <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">homeless</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    homeless <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode_factor</a></span><span class="op">(</span><span class="va">homeless</span>, <span class="st">"0"</span> <span class="op">=</span> <span class="st">"no"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"yes"</span><span class="op">)</span>,</span>
<span>    hiv <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode_factor</a></span><span class="op">(</span></span>
<span>      <span class="va">hivstat</span>,</span>
<span>      <span class="st">"0"</span> <span class="op">=</span> <span class="st">"negative"</span>,</span>
<span>      <span class="st">"1"</span> <span class="op">=</span> <span class="st">"positive"</span>,</span>
<span>      <span class="st">"2"</span> <span class="op">=</span> <span class="st">"positive"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="compare-the-mean-to-the-variance-of-the-outcome-variable--calculate-what-fraction-of-the-counts-are-zero-">Compare the mean to the variance of the outcome variable. Calculate
what fraction of the counts are zero.<a class="anchor" aria-label="anchor" href="#compare-the-mean-to-the-variance-of-the-outcome-variable--calculate-what-fraction-of-the-counts-are-zero-"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">meanvarzeros</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">needledat2</span>,<span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">shared_syr</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">shared_syr</span><span class="op">)</span>,</span>
<span>    var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">shared_syr</span><span class="op">)</span>,</span>
<span>    fraczero <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">shared_syr</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">meanvarzeros</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 Ã— 3</span></span></span>
<span><span class="co">##    mean   var fraczero</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>  3.12  113.    0.774</span></span></code></pre>
<p>The mean number of needle sharing events per participant is 3.12, the
variance is 113, and the fraction of participants who never shared a
needle is 0.774. (Note how I put computed results in the text here
rather than writing in numbers manually - they will change automatically
if the analysis is changed!)</p>
</div>
<div class="section level2">
<h2 id="create-a-histogram-of-the-outcome-variable-">Create a histogram of the outcome variable.<a class="anchor" aria-label="anchor" href="#create-a-histogram-of-the-outcome-variable-"></a>
</h2>
<p>This was done in the lecture using base R, but letâ€™s do it here with
ggplot2. Note the filtering of complete cases only is unnecessary
because ggplot does it anyways, but this gets rid of a warning (try it
without filtering). Specifying the binwidth is also unnecessary, but by
default geom_histogram creates histogram bins of size 2 (ie 0 and 1 in
the same bin, 2 and 3 together, â€¦)</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">needledat2</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">shared_syr</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">shared_syr</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="session_lab_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="fit-poisson-and-negative-binomial-models-as-in-the-lecture-with-and-without-zero-inflation-">Fit Poisson and Negative Binomial models as in the lecture, with and
without zero inflation.<a class="anchor" aria-label="anchor" href="#fit-poisson-and-negative-binomial-models-as-in-the-lecture-with-and-without-zero-inflation-"></a>
</h2>
<div class="section level3">
<h3 id="poisson">Poisson<a class="anchor" aria-label="anchor" href="#poisson"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">shared_syr</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">ethn</span> <span class="op">+</span> <span class="va">homeless</span>,</span>
<span>                data <span class="op">=</span> <span class="va">needledat2</span>,</span>
<span>                family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="negative-binomial">Negative Binomial<a class="anchor" aria-label="anchor" href="#negative-binomial"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'MASS'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     select</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.negbin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html" class="external-link">glm.nb</a></span><span class="op">(</span><span class="va">shared_syr</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">ethn</span> <span class="op">+</span> <span class="va">homeless</span>,</span>
<span>                data <span class="op">=</span> <span class="va">needledat2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="zero-inflated-poisson">Zero-inflated Poisson<a class="anchor" aria-label="anchor" href="#zero-inflated-poisson"></a>
</h3>
<p>The <code>|1</code> creates an intercept-only zero inflation model.
Substitute it with a variable name to add that variable to the count
model, and use regular model formula syntax to create any zero-inflation
logistic regression model you want. Or omit the <code>|</code> for a
full zero-inflation model.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/atahk/pscl" class="external-link">pscl</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Classes and Methods for R originally developed in the</span></span>
<span><span class="co">## Political Science Computational Laboratory</span></span>
<span><span class="co">## Department of Political Science</span></span>
<span><span class="co">## Stanford University (2002-2015),</span></span>
<span><span class="co">## by and under the direction of Simon Jackman.</span></span>
<span><span class="co">## hurdle and zeroinfl functions by Achim Zeileis.</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.ZIpoisfull</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html" class="external-link">zeroinfl</a></span><span class="op">(</span><span class="va">shared_syr</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">ethn</span> <span class="op">+</span> <span class="va">homeless</span>,</span>
<span>                data <span class="op">=</span> <span class="va">needledat2</span>,</span>
<span>                dist <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="intercept-only-zi-poisson-model">Intercept-only ZI Poisson model<a class="anchor" aria-label="anchor" href="#intercept-only-zi-poisson-model"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.ZIpois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html" class="external-link">zeroinfl</a></span><span class="op">(</span><span class="va">shared_syr</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">ethn</span> <span class="op">+</span> <span class="va">homeless</span> <span class="op">|</span> <span class="fl">1</span>,</span>
<span>                data <span class="op">=</span> <span class="va">needledat2</span>,</span>
<span>                dist <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="intercept-only-zi-negative-binomial-model">Intercept-only ZI Negative Binomial model<a class="anchor" aria-label="anchor" href="#intercept-only-zi-negative-binomial-model"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.ZInegbin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html" class="external-link">zeroinfl</a></span><span class="op">(</span><span class="va">shared_syr</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">ethn</span> <span class="op">+</span> <span class="va">homeless</span> <span class="op">|</span> <span class="fl">1</span>,</span>
<span>                data <span class="op">=</span> <span class="va">needledat2</span>,</span>
<span>                dist <span class="op">=</span> <span class="st">"negbin"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="make-a-boxplot-of-needle-sharing-by-homelessness-and-other-predictors">Make a boxplot of needle sharing by homelessness (and other
predictors)<a class="anchor" aria-label="anchor" href="#make-a-boxplot-of-needle-sharing-by-homelessness-and-other-predictors"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">needledat2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ethn</span>, y <span class="op">=</span> <span class="va">shared_syr</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>varwidth <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 2 rows containing non-finite outside the scale range</span></span>
<span><span class="co">## (`stat_boxplot()`).</span></span></code></pre>
<p><img src="session_lab_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="assess-whether-there-may-be-multicollinearity-among-the-predictors">Assess whether there may be multicollinearity among the
predictors<a class="anchor" aria-label="anchor" href="#assess-whether-there-may-be-multicollinearity-among-the-predictors"></a>
</h2>
<p>This uses <code>model.matrix</code> as a trick to produce a numeric
matrix containing numeric and dummy variables, that can be used for
calculating correlations and plotting heatmaps or dendrograms. First,
assessing only three variables. Note, the first column of
<code>mm</code> is the intercept, which must be removed.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">ethn</span> <span class="op">+</span> <span class="va">homeless</span>, data <span class="op">=</span> <span class="va">needledat2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mm</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="session_lab_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Now embed the dendrogram in a heatmap, which may be more or less
informative, but worth trying. Here I use Euclidian distance for rows
(patients) because some rows have zero variance and produce an error
when attempting to calculate correlation, but use Pearson correlation
for columns. The choice of distance metric makes this clustering look
very different. See <code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">?pheatmap</a></code> for other distance metric
options. There are also other heatmap packages, but
<code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">?pheatmap</a></code> makes it easy to produce a basic heatmap.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">pheatmap</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap</a></span><span class="op">(</span><span class="va">mm</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>         clustering_distance_cols <span class="op">=</span> <span class="st">"correlation"</span>,</span>
<span>         clustering_distance_rows <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span></span></code></pre></div>
<p><img src="session_lab_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>Now repeat but assessing all variables, removing <code>id</code>
because itâ€™s just an identifier, and <code>shsyryn</code> because it has
zero variance.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">id</span> <span class="op">-</span> <span class="va">shsyryn</span>, data <span class="op">=</span> <span class="va">needledat2</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="co">#[, -1] gets rid of intercept</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="session_lab_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">pheatmap</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap</a></span><span class="op">(</span><span class="va">mm</span>,</span>
<span>         clustering_distance_cols <span class="op">=</span> <span class="st">"correlation"</span>,</span>
<span>         clustering_distance_rows <span class="op">=</span> <span class="st">"correlation"</span><span class="op">)</span></span></code></pre></div>
<p><img src="session_lab_files/figure-html/unnamed-chunk-11-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="use-chi-square-nested-deviance-tests-to-assess-which-model-seems-to-fit-best-">Use chi-square nested deviance tests to assess which model seems to
fit best.<a class="anchor" aria-label="anchor" href="#use-chi-square-nested-deviance-tests-to-assess-which-model-seems-to-fit-best-"></a>
</h2>
<p>I want to calculate the log-likelihood from each model. The simplest
way is to call the <code>logLik</code> function one at a time:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">fit.pois</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'log Lik.' -730.0133 (df=5)</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">fit.negbin</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'log Lik.' -147.1277 (df=6)</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">fit.ZIpois</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'log Lik.' -303.0276 (df=6)</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">fit.ZInegbin</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'log Lik.' -146.7677 (df=7)</span></span></code></pre>
<p>Just to demonstrate a fancier way that could be used on many models,
Iâ€™ll create a list of model objects:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">listoffits</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    pois <span class="op">=</span> <span class="va">fit.pois</span>,</span>
<span>    negbin <span class="op">=</span> <span class="va">fit.negbin</span>,</span>
<span>    ZIpois <span class="op">=</span> <span class="va">fit.ZIpois</span>,</span>
<span>    ZInegbin <span class="op">=</span> <span class="va">fit.ZInegbin</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Then demonstrate how the <code>lapply</code> (also related functions
like <code>sapply</code>) can be used to implicitly loop over elements
of a list, to do exactly the same thing:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">listoffits</span>, <span class="va">logLik</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $pois</span></span>
<span><span class="co">## 'log Lik.' -730.0133 (df=5)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $negbin</span></span>
<span><span class="co">## 'log Lik.' -147.1277 (df=6)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $ZIpois</span></span>
<span><span class="co">## 'log Lik.' -303.0276 (df=6)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $ZInegbin</span></span>
<span><span class="co">## 'log Lik.' -146.7677 (df=7)</span></span></code></pre>
<p>OK now to actually answer the question. Just to get an idea of how
big a difference in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>âˆ’</mi><mn>2</mn><mo>Ã—</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>l</mi><mi>i</mi><mi>k</mi><mi>e</mi><mi>l</mi><mi>i</mi><mi>h</mi><mi>o</mi><mi>o</mi><mi>d</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">-2 \times log(likelihood)</annotation></semantics></math>
would be statistically significant on one difference of degrees of
freedom:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">qchisq</a></span><span class="op">(</span><span class="fl">0.95</span>, df <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3.841459</span></span></code></pre>
<p>Or two degrees of freedom:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">qchisq</a></span><span class="op">(</span><span class="fl">0.95</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5.991465</span></span></code></pre>
<p>All the differences in double log-likelihoods above are <em>much</em>
larger (in the hundreds) than these critical significance values, except
for the difference between Negative Binomial and zero-inflated negative
binomial models. So it doesnâ€™t look like zero inflation helped the
Negative Binomial distribution model, but it helped the Poisson model,
and the Negative Binomial model fits better than the Poisson model.</p>
</div>
<div class="section level2">
<h2 id="create-residual-deviance-plots-using-the-functions-defined-in-the-lecture-">Create residual deviance plots using the functions defined in the
lecture.<a class="anchor" aria-label="anchor" href="#create-residual-deviance-plots-using-the-functions-defined-in-the-lecture-"></a>
</h2>
<p>These were the (base graphics) functions defined to create the first
two panels of residuals plots for all of these types of models.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plotpanel1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fit</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">"Predicted Values"</span>,</span>
<span>    ylab <span class="op">=</span> <span class="st">"Pearson Residuals"</span>,</span>
<span>    <span class="va">...</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lowess.html" class="external-link">lowess</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">plotpanel2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fit</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">resids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqnorm</a></span><span class="op">(</span><span class="va">resids</span>, ylab <span class="op">=</span> <span class="st">"Std Pearson resid."</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqline</a></span><span class="op">(</span><span class="va">resids</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Letâ€™s make these plots. As a shortcut, remember that list of models?
Iâ€™m going to use an explicit <code>for</code> loop this time instead of
<code>lapply</code> so that I can use the vector names as plot
titles.</p>
<p>Although we saw some evidence from the chi-square test that the
Negative Binomial distribution fit better than the Poisson distribution
(not surprising since these data are very over-dispersed), these
diagnostic plots show the Negative Binomial distribution still does not
fit well at all. I would take any interpretation of the coefficients of
these models with plenty of skepticism. But this dataset is tricky and
Iâ€™m not sure offhand of a good model to fit it.</p>
<p>Note, the line <code>par(mfrow=c(1, 2))</code> only works for base
graphics (not ggplot2), and creates a 1 row by 2 column plot panel.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">listoffits</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">plotpanel1</span><span class="op">(</span><span class="va">listoffits</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">listoffits</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu">plotpanel2</span><span class="op">(</span><span class="va">listoffits</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">listoffits</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="session_lab_files/figure-html/unnamed-chunk-18-1.png" width="700"><img src="session_lab_files/figure-html/unnamed-chunk-18-2.png" width="700"><img src="session_lab_files/figure-html/unnamed-chunk-18-3.png" width="700"><img src="session_lab_files/figure-html/unnamed-chunk-18-4.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="plot-predicted-and-observed-counts">Plot predicted and observed counts<a class="anchor" aria-label="anchor" href="#plot-predicted-and-observed-counts"></a>
</h2>
<p>Here is a <code>data.frame</code> that we can use to make histograms,
density plots, etc.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">preds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>observed <span class="op">=</span> <span class="va">fit.pois</span><span class="op">$</span><span class="va">y</span>,</span>
<span>                    poisson <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit.pois</span><span class="op">)</span>,</span>
<span>                    negbin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit.negbin</span><span class="op">)</span>,</span>
<span>                    ZIpois <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit.ZIpois</span><span class="op">)</span>,</span>
<span>                    ZInegbin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit.ZInegbin</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Just to help with pivoting, letâ€™s pivot this into long-format:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">preds.long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">preds</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>What did this do?</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">preds.long</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      name               value        </span></span>
<span><span class="co">##  Length:575         Min.   :-0.5506  </span></span>
<span><span class="co">##  Class :character   1st Qu.: 0.0000  </span></span>
<span><span class="co">##  Mode  :character   Median : 1.1446  </span></span>
<span><span class="co">##                     Mean   : 2.3125  </span></span>
<span><span class="co">##                     3rd Qu.: 2.5691  </span></span>
<span><span class="co">##                     Max.   :60.0000</span></span></code></pre>
<p>Boxplot</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">preds.long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">name</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="session_lab_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p>Histogram with facet_wrap</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">preds.long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="session_lab_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>We can see that none of the models come close to modeling the extreme
observed counts of 30+. In reality, these might require a more complex
mixture model: for example a mixture of zero-inflation plus two
different count distributions, one with a much higher mean. This is
beyond the scope of the course, but it is possible to fit more complex
mixture models that could fit this dataset better.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://waldronlab.io" class="external-link">Levi Waldron</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
